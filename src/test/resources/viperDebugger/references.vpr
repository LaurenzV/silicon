field val : Int

method test_references(n : Ref)
    requires acc(n.val) && n.val >= 0
{
    var i : Int

    i := 2
    i := i + n.val

    assert i == n.val
}


method test_references2(n : Ref)
    requires acc(n.val, 1/2) && n.val >= 0
{
    var i : Ref
    i := new(*)

    i.val := 2
    i.val := i.val + n.val

    assert i.val == n.val
}

function rand(a : Int): Int
    ensures result >= a

method test_references3(n : Ref)
    requires acc(n.val, 1/2) && n.val >= 0
{
    var i : Ref
    i := new(*)

    if(i.val > 0){
        var j : Int
        j := rand(3)
        i.val := j
    }else{
        var j : Bool
        if(j){
            i.val := 5
        }else{
            i.val := rand(6)
        }
    }

    assert i.val == 5
}